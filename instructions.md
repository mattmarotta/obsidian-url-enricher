# Inline Link Preview - Contributor Notes

## Quick orientation
- Entry point: `src/main.ts` wires plugin lifecycle, paste handler, commands, and status managers.
- Metadata fetching lives in `src/services/linkPreviewService.ts`; formatting logic is in `src/linkPreview`.
- Bulk conversions are implemented in `src/updater/bulkLinkPreviewUpdater.ts` and surfaced through commands in `src/commands/index.ts`.
- The floating progress UI is managed by `src/status/progressStatusManager.ts` with supporting styles in `styles.css`.

## Working guidelines
1. **Run the full build** – `npm run build` must succeed (TypeScript check + bundle).
2. **Run the tests** – `npm test` executes the esbuild-bundled unit tests under `tests/`.
3. **Update documentation** – keep `README.md` (and any user-facing docs) in sync with behaviour changes.
4. **Refresh this file when workflows change** – add any new mandatory steps here so future agents stay aligned.

Always stage code changes under `src/`; `main.js` is generated by the build. Keep progress UI messaging user-friendly and make sure bulk conversions warn the user before editing the active note.

## Testing tips
- Tests stub Obsidian APIs via `tests/stubs/obsidian.ts`; add new helpers there if more API coverage is needed.
- Use the provided `__setRequestUrlMock` augmentation to simulate network requests.
- When adding new behaviour, prefer writing focused unit tests in `tests/previewFormatter.spec.ts` and bundling them with `npm test`.

## Release checklist
- Update `manifest.json`, `versions.json`, and `package.json` when bumping versions.
- Ensure `main.js`, `manifest.json`, and optionally `styles.css` exist at the plugin root for manual installs.
- Document any new network calls or privacy implications in `README.md` before shipping.
